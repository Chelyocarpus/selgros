<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Warning System</title>
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdn.sheetjs.com https://code.jquery.com https://cdn.datatables.net https://unpkg.com https://cdn.jsdelivr.net;
        style-src 'self' 'unsafe-inline' https://cdn.datatables.net https://cdnjs.cloudflare.com https://cdn.jsdelivr.net;
        font-src 'self' https://cdnjs.cloudflare.com;
        img-src 'self' data:;
        connect-src 'self' https://api.github.com https: http://localhost:* http://127.0.0.1:*;
    ">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸ“¦</text></svg>">
    
    <!-- External Libraries -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/dexie@4.0.10/dist/dexie.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/scroller/2.3.0/css/scroller.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/scroller/2.3.0/js/dataTables.scroller.min.js"></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Local Styles -->
    <link rel="stylesheet" href="css/design-tokens.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/tables.css">
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p id="loadingText"></p>
        </div>
    </div>

    <!-- Skip Navigation Links -->
    <a href="#main-content" class="skip-link" id="skipToMainContent"></a>
    <a href="#navigation" class="skip-link" id="skipToNavigation"></a>

    <div class="container" id="main-content" role="main">
        <!-- Header -->
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <div style="flex: 1; min-width: 300px;">
                    <h1 id="headerTitle"><i class="fa-solid fa-boxes-stacked"></i> Lagerbestandswarnsystem</h1>
                    <p id="headerSubtitle">Ãœberwachen Sie LagerbestÃ¤nde und erhalten Sie Warnungen bei KapazitÃ¤tsproblemen</p>
                </div>
                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <!-- Theme Toggle Buttons -->
                    <button onclick="toggleDarkMode()" class="header-btn" id="darkModeBtn" 
                            title="Toggle Dark Mode (Ctrl+Shift+D)" aria-label="Toggle dark mode">
                        <i class="fa-solid fa-moon"></i>
                    </button>
                    <button onclick="toggleHighContrast()" class="header-btn" id="highContrastBtn"
                            title="Toggle High Contrast (Ctrl+Shift+H)" aria-label="Toggle high contrast mode">
                        <i class="fa-solid fa-adjust"></i>
                    </button>
                    <button onclick="toggleReducedMotion()" class="header-btn" id="reducedMotionBtn"
                            title="Toggle Reduced Motion (for better performance)" aria-label="Toggle reduced motion mode"
                            aria-pressed="false">
                        <i class="fa-solid fa-gauge-high"></i>
                    </button>
                    <button onclick="showKeyboardShortcuts()" class="header-btn"
                            title="Keyboard Shortcuts (Ctrl+/)" aria-label="Show keyboard shortcuts">
                        <i class="fa-solid fa-keyboard"></i>
                    </button>
                    <!-- Language Selector -->
                    <div class="language-selector">
                        <select id="languageSelect" onchange="changeLanguage()" class="language-dropdown"
                                aria-label="Select language">
                            <option value="de">ðŸ‡©ðŸ‡ª Deutsch</option>
                            <option value="en">ðŸ‡¬ðŸ‡§ English</option>
                        </select>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <nav class="tabs" id="navigation" role="navigation" aria-label="Main navigation">
            <button class="tab active" onclick="switchTab('check')" 
                    aria-label="Check Stock Tab" aria-controls="checkTab"
                    role="tab" aria-selected="true" id="tab-check">
                <i class="fa-solid fa-magnifying-glass"></i> Check Stock
            </button>
            <button class="tab" onclick="switchTab('materials')" 
                    aria-label="Manage Materials Tab" aria-controls="materialsTab"
                    role="tab" aria-selected="false" id="tab-materials">
                <i class="fa-solid fa-boxes-stacked"></i> Manage Materials
            </button>
            <button class="tab" onclick="switchTab('archive')" 
                    aria-label="Report Archive Tab" aria-controls="archiveTab"
                    role="tab" aria-selected="false" id="tab-archive">
                <i class="fa-solid fa-folder-open"></i> Report Archive
            </button>
            <button class="tab" onclick="switchTab('settings')" 
                    aria-label="Settings & Sync Tab" aria-controls="settingsTab"
                    role="tab" aria-selected="false" id="tab-settings">
                <i class="fa-solid fa-cloud-arrow-up"></i> Sync
            </button>
        </nav>

        <!-- Tab Contents -->
        <div id="checkTab" class="tab-content active" role="tabpanel" aria-labelledby="tab-check"></div>
        <div id="materialsTab" class="tab-content" role="tabpanel" aria-labelledby="tab-materials"></div>
        <div id="archiveTab" class="tab-content" role="tabpanel" aria-labelledby="tab-archive"></div>
        <div id="settingsTab" class="tab-content" role="tabpanel" aria-labelledby="tab-settings"></div>
    </div>

    <!-- Screen Reader Announcements -->
    <div id="srAnnouncements" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Modals -->
    <div id="materialModal" class="modal"></div>
    <div id="viewReportModal" class="modal"></div>
    
    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content delete-modal-content">
            <div class="modal-header">
                <h2 id="deleteModalTitle">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <span id="deleteModalTitleText"></span>
                </h2>
                <button class="modal-close" onclick="ui.closeDeleteModal()" aria-label="Close">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="deleteModalMessage"></p>
                <p class="delete-warning" id="deleteModalWarning"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ui.closeDeleteModal()">
                    <i class="fa-solid fa-xmark"></i>
                    <span id="deleteModalCancelText"></span>
                </button>
                <button class="btn btn-danger" onclick="ui.confirmDelete()">
                    <i class="fa-solid fa-trash-can"></i>
                    <span id="deleteModalConfirmText"></span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Clear All Confirmation Modal -->
    <div id="clearAllModal" class="modal">
        <div class="modal-content clear-all-modal-content">
            <div class="modal-header">
                <h2 id="clearAllModalTitle">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <span id="clearAllModalTitleText"></span>
                </h2>
                <button class="modal-close" onclick="ui.closeClearAllModal()" aria-label="Close">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="clearAllModalMessage" class="clear-all-message"></p>
                <p class="clear-all-warning" id="clearAllModalWarning"></p>
                <div class="clear-all-input-group">
                    <label for="clearAllConfirmInput" id="clearAllModalInstruction"></label>
                    <input 
                        type="text" 
                        id="clearAllConfirmInput" 
                        class="clear-all-input"
                        autocomplete="off"
                        spellcheck="false"
                    />
                    <p class="input-error" id="clearAllInputError"></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ui.closeClearAllModal()">
                    <i class="fa-solid fa-xmark"></i>
                    <span id="clearAllModalCancelText"></span>
                </button>
                <button class="btn btn-danger" onclick="ui.confirmClearAll()">
                    <i class="fa-solid fa-trash-can"></i>
                    <span id="clearAllModalConfirmText"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Local Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/translations.js"></script>
    <script src="js/dixie-db-manager.js"></script>
    <script src="js/cloud-sync-manager.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/report-processor.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/tab-check-stock.js"></script>
    <script src="js/tab-materials.js"></script>
    <script src="js/tab-archive.js"></script>
    <script src="js/tab-settings.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/keyboard-shortcuts.js"></script>
    <script src="js/touch-gestures.js"></script>
    <script src="js/mobile-enhancements.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
